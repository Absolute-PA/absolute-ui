"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[909],{51909:function(e,n,t){t.r(n),t.d(n,{RecordSend:function(){return m}});var o=t(50029),r=t(16835),c=t(13179),i=t(87794),u=t.n(i),s=t(67294),a=t(99603),l=t(59417),f=t(39205),d=t(2453),h=t(71577),v=t(8828),k=t(63444),p=t(8473),g=t(7621),y=t(35944);f.Z.Title,f.Z.Paragraph;var S=(0,c.Z)("div",{target:"e1ifpzql0"})({name:"ykx4hk",styles:"height:100%;width:100%;position:absolute;background:red;top:0;opacity:0.3;border-radius:50%;animation:1s infinite growing;@keyframes growing{from{scale:1;}to{scale:1.8;}}"}),m=function(){var e,n=(0,s.useState)(""),t=n[0],c=n[1],i=(0,s.useState)(!1),f=i[0],m=i[1],b=(0,s.useState)(!1),w=b[0],Z=b[1],_=(0,s.useState)(!1),C=(_[0],_[1]),E=(0,s.useState)(),P=E[0],q=E[1],x=(0,v.Ly)(),T=(0,r.Z)(x,1)[0],I=(0,g.r)(),M=(0,k.s)(p.SocketType.Client),L=(0,s.useCallback)(function(){I&&(I.on("open",function(e){console.log("My peer ID is: "+e),m(!0)}),I.on("error",function(e){console.error(e)}))},[I]),N=(0,s.useCallback)((0,o.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{L()}catch(e){}return e.next=3,T();case 3:case"end":return e.stop()}},e)})),[L,T]);(0,s.useEffect)(function(){if(M)return M.connected&&N(),M.on(p.SocketEvent.Connect,function(){N()}),M.on(p.SocketEvent.ServerPeerId,function(e){e&&c(e)}),function(){M.off(p.SocketEvent.Connect),M.off(p.SocketEvent.ServerPeerId)}},[M,N]);var U=(e=(0,o.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return console.log("Server streaming UI is not ready yet"),e.abrupt("return");case 3:if(I){e.next=6;break}return console.log("Peer hasn't been initialize yet"),e.abrupt("return");case 6:Z(!0),navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(function(e){var n=I.call(t,e);q(n),n.on("stream",function(){console.log("Call is stream")}),n.on("close",function(){console.log("Close call"),e.getTracks().forEach(function(e){return e.stop()})}),n.on("error",function(e){console.log(e,"Error when calling")}),n.on("iceStateChanged",function(e){"disconnected"===e&&m(!1)})}).catch(function(e){var n;C(!0),null!=e&&null!==(n=e.message)&&void 0!==n&&n.includes("Requested device not found")&&d.ZP.warning("Microphone is not detected"),console.log("Failed to get local stream",e)});case 8:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),z=function(){console.log("Stop record"),null==P||P.close(),Z(!1)};return(0,y.BX)(h.ZP,{type:"primary",shape:"circle",onClick:function(){if(w)return z();U()},disabled:!f||!t,children:[(0,y.tZ)(a.G,{icon:l.UOM}),w?(0,y.tZ)(S,{}):null]})};n.default=m},7621:function(e,n,t){t.d(n,{r:function(){return i}});var o=t(10698),r=t(67294),c=t(83454),i=function(){var e=(0,r.useState)(null),n=e[0],t=e[1];return(0,r.useEffect)(function(){var e,n=window.location.hostname,r=new o.ZP({host:n||"localhost",port:Number("8080"),path:"/peer/streaming",debug:3,secure:"true"===c.env.HTTPS});return t(r),function(){null==r||r.destroy()}},[]),n}},63444:function(e,n,t){t.d(n,{s:function(){return i}});var o=t(67294),r=t(70766),c={},i=function(e){var n=(0,o.useState)(null),t=n[0],i=n[1];return(0,o.useEffect)(function(){var n=c[e];if(n){i(n.getSocket());return}var t=new r.C({name:e});return c[e]=t,i(t.getSocket()),function(){t.close()}},[e]),t}},70766:function(e,n,t){t.d(n,{C:function(){return a},n:function(){return o}});var o=function(e){var n=document.querySelector("#audioPlay");n&&(n.srcObject=e,n.addEventListener("canplay",function(){setTimeout(function(){null==n||n.play().catch(function(e){return console.error(e)})},10)}))},r=t(92777),c=t(82262),i=t(59499),u=t(9367),s=t(37107),a=function(){function e(n){(0,r.Z)(this,e),(0,i.Z)(this,"_socket",null),(0,i.Z)(this,"_query",void 0),this._query=n,this.init()}return(0,c.Z)(e,[{key:"init",value:function(){if(!this._socket){var e=(0,s.L)();this._socket=(0,u.io)(e,{query:this._query})}}},{key:"getSocket",value:function(){return this._socket||this.init(),this._socket}},{key:"close",value:function(){this._socket&&(this._socket.close(),this._socket=null)}}]),e}()}}]);