"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[909],{51909:function(e,t,n){n.r(t),n.d(t,{RecordSend:function(){return x}});var r=n(59499),o=n(50029),c=n(16835),i=n(13179),s=n(87794),u=n.n(s),a=n(67294),l=n(99603),f=n(59417),d=n(39205),h=n(2453),p=n(71338),v=n(53575),y=n(71577),g=n(55241),k=n(8828),m=n(63444),b=n(8473),Z=n(7621),w=n(35944);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}d.Z.Title,d.Z.Paragraph;var P=(0,i.Z)("div",{target:"e1ifpzql0"})({name:"ykx4hk",styles:"height:100%;width:100%;position:absolute;background:red;top:0;opacity:0.3;border-radius:50%;animation:1s infinite growing;@keyframes growing{from{scale:1;}to{scale:1.8;}}"}),_={0:"0",50:"50",100:{style:{color:"#f50"},label:"100"}},C={name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"},E={name:"1d3w5wq",styles:"width:100%"},j={name:"1mys3sh",styles:"margin-left:1rem"},q={name:"10kuhi4",styles:"margin-left:1.25rem"},x=function(e){var t,n=(0,a.useState)(50),r=n[0],i=n[1],s=(0,a.useState)(""),d=s[0],S=s[1],x=(0,a.useState)(!1),T=x[0],D=x[1],I=(0,a.useState)(!1),U=I[0],B=I[1],L=(0,a.useState)(!1),M=(L[0],L[1]),N=(0,a.useState)(),X=N[0],z=N[1],G=(0,k.Ly)(),R=(0,c.Z)(G,1)[0],A=(0,Z.r)(),F=(0,m.s)(b.SocketType.Client),H=(0,a.useCallback)(function(){A&&(A.on("open",function(e){console.log("My peer ID is: "+e),D(!0)}),A.on("error",function(e){console.error(e)}))},[A]),Q=(0,a.useCallback)((0,o.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{H()}catch(e){}return e.next=3,R();case 3:case"end":return e.stop()}},e)})),[H,R]);(0,a.useEffect)(function(){if(F)return F.connected&&(Q(),F.on("volume",function(e){i(null!=e?e:50)})),F.on(b.SocketEvent.Connect,function(){Q()}),F.on(b.SocketEvent.ServerPeerId,function(e){e&&S(e)}),function(){F.off(b.SocketEvent.Connect),F.off(b.SocketEvent.ServerPeerId)}},[F,Q]);var V=(t=(0,o.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=3;break}return console.log("Server streaming UI is not ready yet"),e.abrupt("return");case 3:if(A){e.next=6;break}return console.log("Peer hasn't been initialize yet"),e.abrupt("return");case 6:B(!0),navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(function(e){var t=A.call(d,e);z(t),t.on("stream",function(){console.log("Call is stream")}),t.on("close",function(){console.log("Close call"),e.getTracks().forEach(function(e){return e.stop()})}),t.on("error",function(e){console.log(e,"Error when calling")}),t.on("iceStateChanged",function(e){"disconnected"===e&&D(!1)})}).catch(function(e){var t;M(!0),null!=e&&null!==(t=e.message)&&void 0!==t&&t.includes("Requested device not found")&&h.ZP.warning("Microphone is not detected"),console.log("Failed to get local stream",e)});case 8:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),J=function(){console.log("Stop record"),null==X||X.close(),B(!1)},K=(0,w.BX)("div",{css:C,style:{height:"200px"},children:[(0,w.tZ)(p.Z,{css:E,vertical:!0,defaultValue:50,onChange:function(e){i(e),null==F||F.emit("volume",e)},value:r,marks:_}),(0,w.tZ)("div",{css:j,children:(0,w.tZ)(v.Z,{count:r,color:"rgb(45, 183, 245)",showZero:!0})})]});return(0,w.BX)("div",{children:[(0,w.BX)(y.ZP,O(O({type:"primary",shape:"circle",onClick:function(){if(U)return J();V()},disabled:!T||!d},e),{},{children:[(0,w.tZ)(l.G,{icon:f.UOM}),U?(0,w.tZ)(P,{}):null]})),(0,w.tZ)(g.Z,{content:K,title:"Update volume",children:(0,w.tZ)(y.ZP,{type:"primary",shape:"circle",css:q,children:(0,w.tZ)(l.G,{icon:f.AQZ})})})]})};t.default=x},7621:function(e,t,n){n.d(t,{r:function(){return c}});var r=n(10698),o=n(67294),c=function(){var e=(0,o.useState)(null),t=e[0],n=e[1];return(0,o.useEffect)(function(){console.log("true","process.env.NEXT_PUBLIC_HTTPS");var e=window.location.hostname,t=new r.ZP({host:e||"localhost",port:Number("8080"),path:"/peer/streaming",debug:3,secure:!0});return n(t),function(){null==t||t.destroy()}},[]),t}},63444:function(e,t,n){n.d(t,{s:function(){return i}});var r=n(67294),o=n(70766),c={},i=function(e){var t=(0,r.useState)(null),n=t[0],i=t[1];return(0,r.useEffect)(function(){var t=c[e];if(t){i(t.getSocket());return}var n=new o.C({name:e});return c[e]=n,i(n.getSocket()),function(){n.close()}},[e]),n}},70766:function(e,t,n){n.d(t,{C:function(){return a},n:function(){return r}});var r=function(e){var t=document.querySelector("#audioPlay");t&&(t.srcObject=e,t.addEventListener("canplay",function(){setTimeout(function(){null==t||t.play().catch(function(e){return console.error(e)})},10)}))},o=n(92777),c=n(82262),i=n(59499),s=n(9367),u=n(37107),a=function(){function e(t){(0,o.Z)(this,e),(0,i.Z)(this,"_socket",null),(0,i.Z)(this,"_query",void 0),this._query=t,this.init()}return(0,c.Z)(e,[{key:"init",value:function(){if(!this._socket){var e=(0,u.L)();this._socket=(0,s.io)(e,{query:this._query})}}},{key:"getSocket",value:function(){return this._socket||this.init(),this._socket}},{key:"close",value:function(){this._socket&&(this._socket.close(),this._socket=null)}}]),e}()}}]);