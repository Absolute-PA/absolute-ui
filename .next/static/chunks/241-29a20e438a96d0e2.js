"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[241],{82241:function(e,t,n){n.d(t,{z:function(){return D},PX:function(){return V},fG:function(){return W}});var r,i,l=n(67294),a=n(71577),o=n(51042),c=n(95918),s=n(50029),u=n(16835),d=n(87794),f=n.n(d),p=n(5298),h=n(3363),y=n(39112),Z=n(59499),m=n(4730),b=n(75008),v=n(35944),O=["onFinish","children"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,Z.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var P=function(e){var t=e.onFinish,n=(e.children,(0,m.Z)(e,O)),r=(0,l.useCallback)(function(e){null==t||t(e)},[t]);return(0,v.tZ)(p.Z,k(k({name:"playlist-form",layout:"vertical",onFinish:r},n),{},{children:(0,v.tZ)(p.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,v.tZ)(b.Z,{})})}))},w=n(75081),C=n(5022),S=n(4034),j=["playlistId","onFinish","children"];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){(0,Z.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var x=function(e){e.playlistId;var t=e.onFinish,n=(e.children,(0,m.Z)(e,j)),r=(0,S.wi)(),i=r.data,a=r.isLoading,o=(0,l.useMemo)(function(){return null==i?void 0:i.map(function(e){return{label:e.name,value:e._id}})},[i]),c=(0,l.useCallback)(function(e){null==t||t(e)},[t]);return a?(0,v.tZ)(w.Z,{}):(0,v.tZ)(p.Z,I(I({name:"SelectSongs-form",layout:"vertical",onFinish:c},n),{},{children:(0,v.tZ)(p.Z.Item,{name:"songIds",label:"Select Songs",rules:[{required:!0}],children:(0,v.tZ)(C.Z,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",options:o})})}))};(r=i||(i={})).Update="Update",r.Create="Create";var N={name:"yz1nei",styles:"margin-top:16px"},F=function(e){var t,n,r=e.id,o=e.className,c=e.onFinish,d=(0,l.useMemo)(function(){return r?i.Update:i.Create},[r]),Z=(0,l.useState)(0),m=Z[0],b=Z[1],O=(0,y.tS)(),g=(0,u.Z)(O,2),k=g[0],w=g[1],C=w.data,S=w.isLoading,j=(0,y.Xc)(),_=(0,u.Z)(j,2),I=_[0],F=_[1],D=F.data,X=F.isLoading,E=p.Z.useForm(),B=(0,u.Z)(E,1)[0],L=p.Z.useForm(),M=(0,u.Z)(L,1)[0],U=C||D,Y=(0,l.useCallback)((t=(0,s.Z)(f().mark(function e(t){var n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=d===i.Update?I:k,e.next=3,n({id:r,data:t});case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[k,r,d,I]),z=(0,l.useCallback)((n=(0,s.Z)(f().mark(function e(t){var n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.songIds,null!=U&&U._id){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,I({id:U._id,data:{soundIds:n}});case 5:null==c||c();case 6:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[null==U?void 0:U._id,c,I]),H=(0,l.useMemo)(function(){return[{title:"Info",content:(0,v.tZ)(P,{form:B,onFinish:Y})},{title:"Select Songs",content:null!=U&&U._id?(0,v.tZ)(x,{form:M,playlistId:U._id,onFinish:z}):null}]},[B,null==U?void 0:U._id,Y,z,M]),T=H.map(function(e){return{key:e.title,title:e.title}}),q=(0,l.useCallback)(function(){switch(m){case 0:B.submit(),b(m+1);break;case 1:M.submit()}},[B,m,M]);return(0,l.useCallback)(function(){b(m-1)},[m]),(0,v.BX)("div",{className:o,children:[(0,v.tZ)(h.Z,{current:m,items:T}),(0,v.tZ)("div",{css:N,children:H[m].content}),(0,v.BX)("div",{style:{marginTop:24},children:[m<H.length-1&&(0,v.tZ)(a.ZP,{loading:S||X,type:"primary",onClick:q,children:"Next"}),m===H.length-1&&(0,v.tZ)(a.ZP,{type:"primary",onClick:q,children:"Finish"})]})]})},D=function(e){var t=e.className,n=(0,l.useState)(!1),r=n[0],i=n[1],s=function(){return i(!1)};return(0,v.BX)(v.HY,{children:[(0,v.tZ)(a.ZP,{className:t,type:"primary",onClick:function(){return i(!0)},icon:(0,v.tZ)(o.Z,{}),children:"Create Playlist"}),(0,v.tZ)(c.dy,{title:"Create a new playlist",open:r,onClose:s,destroyOnClose:!0,children:(0,v.tZ)(F,{onFinish:s})})]})},X=n(51904),E=n(42075),B=n(70149),L=n(8828),M=n(5737),U=n(47748),Y=function(e){var t=e.className,n=e.playlistId,r=(0,U.R8)(),i=(0,u.Z)(r,1)[0];return(0,v.tZ)(M.Z,{className:t,title:"Delete the playlist",description:"Are you sure to delete this playlist?",onConfirm:function(){i({id:n,data:void 0})},okText:"Yes",cancelText:"No",children:(0,v.tZ)("a",{children:"Delete"})})},z=function(e){e.className;var t=e.playlistId,n=(0,l.useState)(!1),r=n[0],i=n[1],a=function(){return i(!1)};return(0,v.BX)(v.HY,{children:[(0,v.tZ)("a",{onClick:function(){return i(!0)},children:"Edit"}),(0,v.tZ)(c.dy,{title:"Edit Playlist",open:r,onClose:a,destroyOnClose:!0,children:(0,v.tZ)(F,{id:t,onFinish:a})})]})},H=n(8473),T=n(33957),q=function(e){var t,n=e.playlist,r=(0,U.dZ)(),i=(0,u.Z)(r,1)[0],l=(0,T.M)(n._id),a=(null==l?void 0:l.isPlaying)!==void 0?l.isPlaying:!!n.jobId,o=(t=(0,s.Z)(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({id:null==n?void 0:n._id,operation:a?H.PlaylistOperation.Stop:H.PlaylistOperation.Play});case 2:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});return(0,v.tZ)("a",{onClick:o,children:a?"Stop":"Play"})},A=n(72269),G=n(99603),K=n(59417),R={name:"9o98sf",styles:"display:flex;align-items:center;column-gap:0.375rem"},J=function(e){var t=e.playlist,n=(0,L.Xc)(),r=(0,u.Z)(n,1)[0],i=(0,l.useState)(!!(null!=t&&t.isShuffle)),a=i[0],o=i[1];return(0,v.BX)("div",{css:R,children:[(0,v.tZ)(A.Z,{defaultChecked:!!(null!=t&&t.isShuffle),onChange:function(e){o(e),r({id:null==t?void 0:t._id,data:{isShuffle:e}})}}),a&&(0,v.tZ)(G.G,{icon:K.a_u}),a&&(0,v.tZ)("span",{children:"Shuffle"})]})},Q=[{title:"Name",dataIndex:"name",key:"name",render:function(e){return(0,v.tZ)("span",{children:e})}},{title:"Songs",dataIndex:"sounds",key:"sounds",width:500,render:function(e,t){return(0,v.tZ)(v.HY,{children:e.map(function(e){return(0,v.tZ)(X.Z,{children:e.name},e._id)})})}},{title:"Shuffle",dataIndex:"isShuffle",key:"isShuffle",width:160,render:function(e,t){return(0,v.tZ)(J,{playlist:t})}},{title:"Actions",key:"actions",render:function(e,t){return(0,v.BX)(E.Z,{size:"middle",children:[(0,v.tZ)(q,{playlist:t}),(0,v.tZ)(z,{playlistId:t._id}),(0,v.tZ)(Y,{playlistId:t._id})]})}}],V=function(e){var t=e.className,n=e.title,r=(0,L.a9)(),i=r.data,l=r.isLoading;return(0,v.tZ)(B.Z,{scroll:{x:"max-content"},caption:n,className:t,loading:l,columns:Q,dataSource:i,rowKey:function(e){return e._id}})},W=function(e){var t=e.playlistId,n=(0,L.a9)().data,r=null==n?void 0:n.find(function(e){return e._id===t});return r?(0,v.tZ)("span",{children:r.name}):null}}}]);