"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{90427:function(e,t,n){n.d(t,{vU:function(){return H},xF:function(){return Y},ol:function(){return U}});var r,i,s=n(59499),o=n(4730),c=n(5022),a=n(75008),u=n(5298);(r=i||(i={})).User="user",r.Admin="admin";var l=n(35944),d=["editing","dataIndex","title","inputType","record","index","children","form"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){(0,s.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}c.Z.Option;var m=[{value:i.Admin,label:"Admin"},{value:i.User,label:"User"}],Z=function(e){var t=e.editing,n=e.dataIndex,r=e.title,i=e.inputType,s=(e.record,e.index,e.children),p=e.form,Z=(0,o.Z)(e,d),h="multi-select"===i?(0,l.tZ)(c.Z,{mode:"multiple",placeholder:"Please select",onChange:function(e){p.setFieldsValue({roles:e})},options:m}):(0,l.tZ)(a.Z,{});return(0,l.tZ)("td",f(f({},Z),{},{children:t?(0,l.tZ)(u.Z.Item,{name:n,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(r,"!")}],children:h}):s}))},h=n(27812),w=n(50029),y=n(16835),P=n(87794),g=n.n(P),b=n(67294),v=n(2453),O=n(39205),x=n(5737),k=n(42075),j=n(71577),C=n(70149),S=n(59309),I=n(20990),E=n(96807);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){(0,s.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var U=function(e){var t,n,r,i=e.users.map(function(e){return{key:e.email,email:e.email,username:e.username,roles:e.roles,id:e.id}}),s=u.Z.useForm(),o=(0,y.Z)(s,1)[0],c=(0,b.useState)(i),a=c[0],d=c[1],p=(0,b.useState)(""),f=p[0],m=p[1],P=(0,S.kD)(),T=(0,y.Z)(P,2),U=T[0];T[1].isSuccess;var D=(0,I.I1)(),N=(0,y.Z)(D,2),F=N[0];N[1].isSuccess;var A=(0,E.PI)(),V=(0,y.Z)(A,2),X=V[0];V[1].isSuccess;var R=function(e){return e.email===f},Y=function(e){o.setFieldsValue(B({},e)),e.email&&m(e.email)},_=(t=(0,w.Z)(g().mark(function e(t){var n,r,i,s;return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.validateFields();case 3:n=e.sent,(i=(r=(0,h.Z)(a)).findIndex(function(e){return t===e.email}))>-1?(s=B(B({},r[i]),n),r.splice(i,1,s),d(r),U(s).unwrap().then(function(e){v.ZP.success("Success update user"),m("")}).catch(function(){return v.ZP.error("Something is wrong")})):(r.push(n),d(r),m("")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])})),function(e){return t.apply(this,arguments)}),q=function(){m("")},H=(n=(0,w.Z)(g().mark(function e(t){return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:F(t).unwrap().then(function(){v.ZP.success("Success delete user")}).catch(function(){return v.ZP.error("Something is wrong")});case 1:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),z=(r=(0,w.Z)(g().mark(function e(t){return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(t);case 2:e.sent.isSuccess?v.ZP.success("Success reset password user. Please use the default password to login."):v.ZP.error("Something is wrong");case 4:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),L=function(){},W=function(){},G=[{title:"Username",dataIndex:"username",key:"username"},{title:"Email",dataIndex:"email",key:"email"},{title:"Roles",dataIndex:"roles",key:"roles",render:function(e){return e.map(function(e){return(0,l.tZ)("p",{children:e},e)})}},{title:"Actions",key:"actions",dataIndex:"actions",render:function(e,t){return R(t)?(0,l.BX)("span",{children:[(0,l.tZ)(O.Z.Link,{onClick:function(){return _(t.email)},style:{marginRight:8},children:"Save"}),(0,l.tZ)(x.Z,{title:"Sure to cancel?",onConfirm:q,children:(0,l.tZ)("a",{children:"Cancel"})})]}):(0,l.BX)(k.Z,{size:"middle",children:[(0,l.tZ)(x.Z,{title:"Delete the user",description:"Are you sure to delete this user?",onConfirm:function(){return H(t.id)},onCancel:L,okText:"Yes",cancelText:"No",children:(0,l.tZ)(j.ZP,{type:"link",children:"Delete"})}),(0,l.tZ)(j.ZP,{type:"link",onClick:function(){return Y(B(B({},t),{},{key:t.email}))},children:"Edit"}),(0,l.tZ)(x.Z,{title:"Reset password",description:"Are you sure to reset password for this user?",onConfirm:function(){return z(t.id)},onCancel:W,okText:"Yes",cancelText:"No",children:(0,l.tZ)(j.ZP,{type:"link",children:"Reset Password"})})]})}}].map(function(e){return["actions"].includes(e.key)?e:B(B({},e),{},{onCell:function(t){return{record:t,inputType:"roles"===e.dataIndex?"multi-select":"text",dataIndex:e.dataIndex,title:e.title||"",editing:R(t),form:o}}})});return(0,l.tZ)(l.HY,{children:(0,l.tZ)(u.Z,{form:o,component:!1,children:(0,l.tZ)(C.Z,{scroll:{x:"max-content"},components:{body:{cell:Z}},bordered:!0,dataSource:a,columns:G,rowClassName:"editable-row",pagination:{onChange:q}})})})},D=n(75081),N=n(94149),F=n(87547),A=n(9443),V=n(8828),X={name:"1j389vi",styles:"font-weight:700"},R={name:"1j389vi",styles:"font-weight:700"},Y=(0,A.h4)(function(e){var t,n=e.className,r=e.header,i=(0,b.useContext)(A.j8),s=i.isEditing,o=i.setEditing,c=(0,V.XC)().data,d=u.Z.useForm(),p=(0,y.Z)(d,1)[0],f=(0,V.We)(),m=(0,y.Z)(f,1)[0],Z=(t=(0,w.Z)(g().mark(function e(t){return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t);case 2:"data"in e.sent&&(v.ZP.success("Updated password successfully."),o(!1));case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)});return(0,l.BX)(A.Uf,{className:n,header:r||"User",icon:(0,l.tZ)(F.Z,{}),defaultActive:!0,children:[!c&&(0,l.tZ)(D.Z,{}),!!c&&(0,l.BX)(l.HY,{children:[(0,l.tZ)(A.Uf.EditButton,{onClick:function(){return o(!s)}}),(0,l.BX)(A.Tr,{form:p,initialValues:c,onFinish:Z,children:[(0,l.BX)(A.Tr.Row,{children:[(0,l.tZ)(A.Tr.Item,{name:["username"],label:"User name",isEditing:!1,children:(0,l.tZ)(a.Z,{})}),(0,l.tZ)(A.Tr.Item,{name:["email"],label:"Email",isEditing:!1,children:(0,l.tZ)(a.Z,{})}),(0,l.tZ)(A.Tr.Item,{name:["newPassword"],label:"New Password",rules:[{required:!0}],renderViewValue:function(){return(0,l.tZ)("div",{css:X,children:"********"})},children:(0,l.tZ)(a.Z.Password,{prefix:(0,l.tZ)(N.Z,{}),type:"password",placeholder:"New Password"})}),(0,l.tZ)(A.Tr.Item,{name:["confirmPassword"],dependencies:["newPassword"],label:"Confirm Password",renderViewValue:function(){return(0,l.tZ)("div",{css:R,children:"********"})},rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("newPassword")!==n?Promise.reject(Error("The new password that you entered do not match!")):Promise.resolve()}}}],children:(0,l.tZ)(a.Z.Password,{prefix:(0,l.tZ)(N.Z,{}),type:"password",placeholder:"Confirm Password"})})]}),s&&(0,l.tZ)(A.Uf.FooterActions,{children:(0,l.tZ)(A.Tr.Actions,{})})]})]})]})}),_=n(51042),q=n(76809),H=function(e){var t=e.className,n=(0,b.useState)(!1),r=n[0],i=n[1];return(0,l.BX)(l.HY,{children:[(0,l.tZ)(j.ZP,{className:t,type:"primary",onClick:function(){return i(!0)},icon:(0,l.tZ)(_.Z,{}),children:"Create User"}),(0,l.tZ)(A.dy,{title:"Create new user",open:r,onClose:function(){return i(!1)},destroyOnClose:!0,children:(0,l.tZ)(q.B2,{title:"none",hasSpacing:!1,hasBlockBtn:!1,confirmBtnPosition:"right"})})]})}}}]);