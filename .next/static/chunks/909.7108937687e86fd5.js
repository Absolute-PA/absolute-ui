"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[909],{51909:function(e,t,n){n.r(t),n.d(t,{RecordSend:function(){return q}});var o=n(59499),r=n(50029),c=n(16835),i=n(13179),s=n(87794),u=n.n(s),a=n(67294),l=n(99603),f=n(59417),d=n(5178),h=n(2453),p=n(71338),v=n(53575),y=n(71577),g=n(55241),m=n(8828),k=n(63444),b=n(8473),w=n(7621),Z=n(35944);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}d.Z.Title,d.Z.Paragraph;var P=(0,i.Z)("div",{target:"e1ifpzql0"})({name:"ykx4hk",styles:"height:100%;width:100%;position:absolute;background:red;top:0;opacity:0.3;border-radius:50%;animation:1s infinite growing;@keyframes growing{from{scale:1;}to{scale:1.8;}}"}),O={0:"0",50:"50",100:{style:{color:"#f50"},label:"100"}},E={name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"},C={name:"1d3w5wq",styles:"width:100%"},j={name:"1mys3sh",styles:"margin-left:1rem"},T={name:"10kuhi4",styles:"margin-left:1.25rem"},q=function(e){var t,n=(0,a.useState)(50),o=n[0],i=n[1],s=(0,a.useState)(""),d=s[0],S=s[1],q=(0,a.useState)(!1),x=q[0],D=q[1],I=(0,a.useState)(!1),N=I[0],U=I[1],B=(0,a.useState)(!1),L=(B[0],B[1]),R=(0,a.useState)(),X=R[0],M=R[1],V=(0,m.Ly)(),z=(0,c.Z)(V,1)[0],G=(0,w.r)(),A=(0,k.s)(b.SocketType.Client),F=(0,a.useCallback)(function(){G&&(G.on("open",function(e){console.log("My peer ID is: "+e),D(!0)}),G.on("error",function(e){console.error(e)}))},[G]),H=(0,a.useCallback)((0,r.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{F()}catch(e){}return e.next=3,z();case 3:case"end":return e.stop()}},e)})),[F,z]);(0,a.useEffect)(function(){if(A)return A.connected&&(H(),A.on("volume",function(e){i(null!=e?e:50)})),A.on(b.SocketEvent.Connect,function(){H()}),A.on(b.SocketEvent.ServerPeerId,function(e){e&&S(e)}),function(){A.off(b.SocketEvent.Connect),A.off(b.SocketEvent.ServerPeerId),A.off("volume")}},[A,H]);var Q=(t=(0,r.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=3;break}return console.log("Server streaming UI is not ready yet"),e.abrupt("return");case 3:if(G){e.next=6;break}return console.log("Peer hasn't been initialize yet"),e.abrupt("return");case 6:U(!0),navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(function(e){var t=G.call(d,e);M(t),t.on("stream",function(){console.log("Call is stream")}),t.on("close",function(){console.log("Close call"),e.getTracks().forEach(function(e){return e.stop()})}),t.on("error",function(e){console.log(e,"Error when calling")}),t.on("iceStateChanged",function(e){"disconnected"===e&&D(!1)})}).catch(function(e){var t;L(!0),null!=e&&null!==(t=e.message)&&void 0!==t&&t.includes("Requested device not found")&&h.ZP.warning("Microphone is not detected"),console.log("Failed to get local stream",e)});case 8:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),J=function(){console.log("Stop record"),null==X||X.close(),U(!1)},K=(0,Z.BX)("div",{css:E,style:{height:"200px"},children:[(0,Z.tZ)(p.Z,{css:C,vertical:!0,defaultValue:50,onChange:function(e){i(e),null==A||A.emit("volume",e)},value:o,marks:O}),(0,Z.tZ)("div",{css:j,children:(0,Z.tZ)(v.Z,{count:o,color:"rgb(45, 183, 245)",showZero:!0})})]});return(0,Z.BX)("div",{children:[(0,Z.BX)(y.ZP,_(_({type:"primary",shape:"circle",onClick:function(){if(N)return J();Q()},disabled:!x||!d},e),{},{children:[(0,Z.tZ)(l.G,{icon:f.UOM}),N?(0,Z.tZ)(P,{}):null]})),(0,Z.tZ)(g.Z,{content:K,title:"Update volume",children:(0,Z.tZ)(y.ZP,{type:"primary",shape:"circle",css:T,children:(0,Z.tZ)(l.G,{icon:f.AQZ})})})]})};t.default=q},7621:function(e,t,n){n.d(t,{r:function(){return c}});var o=n(10698),r=n(67294),c=function(){var e=(0,r.useState)(null),t=e[0],n=e[1];return(0,r.useEffect)(function(){console.log("true","process.env.NEXT_PUBLIC_HTTPS");var e=window.location.hostname,t=new o.ZP({host:e||"localhost",port:Number(window.__ENV.NEXT_PUBLIC_SERVER_PORT||8080),path:"/peer/streaming",debug:3,secure:!0});return n(t),function(){null==t||t.destroy()}},[]),t}},63444:function(e,t,n){n.d(t,{s:function(){return i}});var o=n(67294),r=n(70766),c={},i=function(e){var t=(0,o.useState)(null),n=t[0],i=t[1];return(0,o.useEffect)(function(){var t=c[e];if(t){i(t.getSocket());return}var n=new r.C({name:e});return c[e]=n,i(n.getSocket()),function(){n.close()}},[e]),n}},70766:function(e,t,n){n.d(t,{C:function(){return a},n:function(){return o}});var o=function(e){var t=document.querySelector("#audioPlay");t&&(t.srcObject=e,t.addEventListener("canplay",function(){setTimeout(function(){null==t||t.play().catch(function(e){return console.error(e)})},10)}))},r=n(92777),c=n(82262),i=n(59499),s=n(9367),u=n(37107),a=function(){function e(t){(0,r.Z)(this,e),(0,i.Z)(this,"_socket",null),(0,i.Z)(this,"_query",void 0),this._query=t,this.init()}return(0,c.Z)(e,[{key:"init",value:function(){if(!this._socket){var e=(0,u.L)();this._socket=(0,s.io)(e,{query:this._query}),this._socket.on("connect_error",function(e){console.log(e.message),console.log(e)})}}},{key:"getSocket",value:function(){return this._socket||this.init(),this._socket}},{key:"close",value:function(){this._socket&&(this._socket.close(),this._socket=null)}}]),e}()}}]);