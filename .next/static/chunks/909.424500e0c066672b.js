"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[909],{51909:function(e,t,n){n.r(t),n.d(t,{RecordSend:function(){return O}});var r=n(59499),o=n(50029),c=n(16835),i=n(13179),u=n(87794),s=n.n(u),a=n(67294),l=n(99603),f=n(59417),d=n(39205),p=n(2453),h=n(71577),v=n(8828),g=n(63444),y=n(8473),k=n(7621),b=n(35944);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}d.Z.Title,d.Z.Paragraph;var w=(0,i.Z)("div",{target:"e1ifpzql0"})({name:"ykx4hk",styles:"height:100%;width:100%;position:absolute;background:red;top:0;opacity:0.3;border-radius:50%;animation:1s infinite growing;@keyframes growing{from{scale:1;}to{scale:1.8;}}"}),O=function(e){var t,n=(0,a.useState)(""),r=n[0],i=n[1],u=(0,a.useState)(!1),d=u[0],S=u[1],O=(0,a.useState)(!1),P=O[0],Z=O[1],_=(0,a.useState)(!1),E=(_[0],_[1]),C=(0,a.useState)(),j=C[0],q=C[1],x=(0,v.Ly)(),D=(0,c.Z)(x,1)[0],T=(0,k.r)(),I=(0,g.s)(y.SocketType.Client),M=(0,a.useCallback)(function(){T&&(T.on("open",function(e){console.log("My peer ID is: "+e),S(!0)}),T.on("error",function(e){console.error(e)}))},[T]),L=(0,a.useCallback)((0,o.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{M()}catch(e){}return e.next=3,D();case 3:case"end":return e.stop()}},e)})),[M,D]);(0,a.useEffect)(function(){if(I)return I.connected&&L(),I.on(y.SocketEvent.Connect,function(){L()}),I.on(y.SocketEvent.ServerPeerId,function(e){e&&i(e)}),function(){I.off(y.SocketEvent.Connect),I.off(y.SocketEvent.ServerPeerId)}},[I,L]);var N=(t=(0,o.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return console.log("Server streaming UI is not ready yet"),e.abrupt("return");case 3:if(T){e.next=6;break}return console.log("Peer hasn't been initialize yet"),e.abrupt("return");case 6:Z(!0),navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(function(e){var t=T.call(r,e);q(t),t.on("stream",function(){console.log("Call is stream")}),t.on("close",function(){console.log("Close call"),e.getTracks().forEach(function(e){return e.stop()})}),t.on("error",function(e){console.log(e,"Error when calling")}),t.on("iceStateChanged",function(e){"disconnected"===e&&S(!1)})}).catch(function(e){var t;E(!0),null!=e&&null!==(t=e.message)&&void 0!==t&&t.includes("Requested device not found")&&p.ZP.warning("Microphone is not detected"),console.log("Failed to get local stream",e)});case 8:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),U=function(){console.log("Stop record"),null==j||j.close(),Z(!1)};return(0,b.BX)(h.ZP,m(m({type:"primary",shape:"circle",onClick:function(){if(P)return U();N()},disabled:!d||!r},e),{},{children:[(0,b.tZ)(l.G,{icon:f.UOM}),P?(0,b.tZ)(w,{}):null]}))};t.default=O},7621:function(e,t,n){n.d(t,{r:function(){return i}});var r=n(10698),o=n(67294),c=n(83454),i=function(){var e=(0,o.useState)(null),t=e[0],n=e[1];return(0,o.useEffect)(function(){var e,t=window.location.hostname,o=new r.ZP({host:t||"localhost",port:Number("8080"),path:"/peer/streaming",debug:3,secure:"true"===c.env.HTTPS});return n(o),function(){null==o||o.destroy()}},[]),t}},63444:function(e,t,n){n.d(t,{s:function(){return i}});var r=n(67294),o=n(70766),c={},i=function(e){var t=(0,r.useState)(null),n=t[0],i=t[1];return(0,r.useEffect)(function(){var t=c[e];if(t){i(t.getSocket());return}var n=new o.C({name:e});return c[e]=n,i(n.getSocket()),function(){n.close()}},[e]),n}},70766:function(e,t,n){n.d(t,{C:function(){return a},n:function(){return r}});var r=function(e){var t=document.querySelector("#audioPlay");t&&(t.srcObject=e,t.addEventListener("canplay",function(){setTimeout(function(){null==t||t.play().catch(function(e){return console.error(e)})},10)}))},o=n(92777),c=n(82262),i=n(59499),u=n(9367),s=n(37107),a=function(){function e(t){(0,o.Z)(this,e),(0,i.Z)(this,"_socket",null),(0,i.Z)(this,"_query",void 0),this._query=t,this.init()}return(0,c.Z)(e,[{key:"init",value:function(){if(!this._socket){var e=(0,s.L)();this._socket=(0,u.io)(e,{query:this._query})}}},{key:"getSocket",value:function(){return this._socket||this.init(),this._socket}},{key:"close",value:function(){this._socket&&(this._socket.close(),this._socket=null)}}]),e}()}}]);